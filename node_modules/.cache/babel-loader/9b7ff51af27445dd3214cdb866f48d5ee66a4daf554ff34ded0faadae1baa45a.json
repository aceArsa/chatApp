{"ast":null,"code":"import{useEffect,useState}from\"react\";import{addDoc,collection,onSnapshot,orderBy,query,serverTimestamp,where}from\"firebase/firestore\";import{auth,db}from\"../firebase-config\";import\"../styles/Chat.css\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export const Chat=props=>{const{room}=props;const[newMessage,setNewMesssage]=useState(\"\");const[messages,setMessages]=useState([]);const messagesRef=collection(db,\"messages\");useEffect(()=>{const queryMessages=query(messagesRef,where(\"room\",\"==\",room),orderBy(\"createdAt\"));const unsubscribe=onSnapshot(queryMessages,snapshot=>{let messages=[];snapshot.forEach(doc=>{messages.push({...doc.data(),id:doc.id});});setMessages(messages);});return()=>unsubscribe();},[]);const handleSubmit=async e=>{e.preventDefault();if(newMessage===\"\")return;await addDoc(messagesRef,{text:newMessage,createdAt:serverTimestamp(),user:auth.currentUser.displayName,room});setNewMesssage(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-app\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[\" Welcome to: \",room.toUpperCase()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"messages\",children:messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"user\",children:[\" \",message.user,\" \"]}),message.text]},message.id))}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"new-message-form\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"new-message-input\",placeholder:\"Type your message here...\",onChange:e=>setNewMesssage(e.target.value),value:newMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",children:\"Send\"})]})]});};","map":{"version":3,"names":["useEffect","useState","addDoc","collection","onSnapshot","orderBy","query","serverTimestamp","where","auth","db","jsxs","_jsxs","jsx","_jsx","Chat","props","room","newMessage","setNewMesssage","messages","setMessages","messagesRef","queryMessages","unsubscribe","snapshot","forEach","doc","push","data","id","handleSubmit","e","preventDefault","text","createdAt","user","currentUser","displayName","className","children","toUpperCase","map","message","onSubmit","placeholder","onChange","target","value","type"],"sources":["C:/Users/msu-wone/Desktop/chatMe/src/components/Chat.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { addDoc, collection, onSnapshot, orderBy, query, serverTimestamp, where } from \"firebase/firestore\";\nimport { auth, db } from \"../firebase-config\";\nimport \"../styles/Chat.css\"\n\nexport const Chat = (props) => {\n    const { room } = props;\n    const [ newMessage, setNewMesssage ] = useState(\"\");\n    const [ messages, setMessages] = useState([]);\n\n    const messagesRef = collection(db, \"messages\");\n\n    useEffect(() => {\n        const queryMessages = query(\n            messagesRef, \n            where(\"room\", \"==\", room),\n            orderBy(\"createdAt\")\n        );\n        const unsubscribe = onSnapshot(queryMessages, (snapshot) => {\n            let messages = [];\n            snapshot.forEach((doc) => {\n                messages.push({ ...doc.data(), id: doc.id })\n            });\n            setMessages(messages);\n        });\n\n        return () => unsubscribe();\n    }, [])\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (newMessage === \"\") return;\n\n        await addDoc(messagesRef, {\n            text: newMessage,\n            createdAt: serverTimestamp(),\n            user: auth.currentUser.displayName,\n            room\n        })\n\n        setNewMesssage(\"\")\n    };\n\n    return (\n        <div className=\"chat-app\">\n            <div className=\"header\">\n                <h1> Welcome to: {room.toUpperCase()}</h1>\n            </div>\n            <div className=\"messages\"> \n                { messages.map((message) => (\n                    <div className=\"message\" key={message.id}>\n                        <span className=\"user\"> {message.user} </span>\n                        {message.text}\n                    </div>\n                ))} \n            </div>\n            <form onSubmit={handleSubmit} className=\"new-message-form\">\n                <input \n                    className=\"new-message-input\"\n                    placeholder=\"Type your message here...\"\n                    onChange={(e) => setNewMesssage(e.target.value)}\n                    value={newMessage}\n                />\n                <button type=\"submit\" className=\"send-button\">\n                    Send\n                </button>\n            </form>\n        </div>\n    )\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}